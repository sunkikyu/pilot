import streamlit as st
from datetime import datetime, timedelta
import time

# ğŸšŒ ë…¸ì„ ë³„ ì‹œê°„í‘œ (24ì‹œê°„ì œ ë¬¸ìì—´ ë¦¬ìŠ¤íŠ¸)
bus_timetable = {
    "M4448": ["06:35", "06:45", "06:50", "07:00", "07:10", "07:20", "07:30", "17:10", "17:20", "17:30", "18:00", "18:10", "18:50"],
    "6002-1": ["06:50", "07:10", "07:30", "08:00", "17:30", "18:00", "18:40"],
}

# ğŸš€ Streamlit UI
st.title("ë²„ìŠ¤ ê¸°ì  ì‹¤ì‹œê°„ ì¹´ìš´íŠ¸ë‹¤ìš´")
selected_route = st.selectbox("ë…¸ì„  ì„ íƒ", list(bus_timetable.keys()))

placeholder = st.empty()

def get_next_time(timetable, now):
    now_time = now.time()
    for t_str in timetable:
        t = datetime.strptime(t_str, "%H:%M").time()
        if t > now_time:
            return t
    return None  # ì˜¤ëŠ˜ ë‹¤ ëë‚¬ìœ¼ë©´ None

while True:
    now = datetime.now()
    timetable = bus_timetable[selected_route]
    next_time = get_next_time(timetable, now)

    if next_time:
        next_datetime = datetime.combine(now.date(), next_time)
        diff = next_datetime - now
        mins, secs = divmod(int(diff.total_seconds()), 60)
        time_str = f"{mins}ë¶„ {secs}ì´ˆ ë‚¨ìŒ"
    else:
        time_str = "ì˜¤ëŠ˜ ìš´í–‰ ì¢…ë£Œ"

    placeholder.markdown(f"### í˜„ì¬ ì‹œê°: {now.strftime('%H:%M:%S')}")
    placeholder.markdown(f"### ë‹¤ìŒ ë²„ìŠ¤: {next_time.strftime('%H:%M') if next_time else 'ì—†ìŒ'}")
    placeholder.markdown(f"### ë‚¨ì€ ì‹œê°„: {time_str}")

    time.sleep(1)
